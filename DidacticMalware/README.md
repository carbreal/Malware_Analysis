# Didactic Malware  
I have developed a malware sample in bash in order to test some Linux EDRs. It is intended to be simple, easy and do its job.  
The code is poorly written and there are A LOT of improvements that could be made. At the time, I don't need it to be super functional, complex or undetectable. Just simple.  
  
## ARCHITECTURE  
The Architecture is very simple. A DNS server, a server to host the sample and the C2. For the DNS server, you can set up a Bind server and for the C2 and host server, a simple apache2 or python SimpleHTTPServer will do the trick.  
  
<img src="./Screenshots/Architecture.png" width="80%" />  
  
I quickly started 3 VMs in AWS and the Victim, and in 5 minutes you can have everything working. FYI, it's not up anymore ^^  
  
<img src="./Screenshots/AWS_Deployment.jpg" width="80%" />  
  
  
## Features  
At the moment, the malware just has 4 simple options, execute a command, update a setting, sleep or terminate the process. It reads a b64 text that has to have the action+command. For example, in order to execute the whoami command, the HTTP server should have the following content: echo -n "exec whoami" | base64 -w0 -> ZXhlYyB3aG9hbWk=  
The output of the command will be sent via DNS requests to the DNS server.  
  
<img src="./Screenshots/exfiltration.jpg" width="80%" />  
  
  
## Debug  
The malware writes every action in a log file in order to debug or know what's happening.  
  
<img src="./Screenshots/logfile.jpg" width="80%" />  
  
  
## Persistence  
It copies itself in a hidden folder in a location that has writting permissions and gains persistence editing the crontab. Everything very simple.  
  
<img src="./Screenshots/persistence.jpg" width="80%" />  
<img src="./Screenshots/instalationsettings.jpg" width="80%" />  
  
  

